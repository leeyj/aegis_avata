<!-- Sidebar Menu -->
<button class="sidebar-toggle" id="sidebar-toggle">â€¢â€¢â€¢</button>
<div class="sidebar" id="sidebar">
    <div class="menu-section">
        <h3 data-i18n="sidebar.panel_control">PANEL CONTROL</h3>
        {% set panels = [
            ('vis-title', 'p-title', 'System Title', True),
            ('vis-clock', 'p-clock', 'System Clock', True),
            ('vis-weather', 'p-weather', 'Environmental Info', True),
            ('vis-finance', 'p-finance', 'Market Indices', True),
            ('vis-news', 'p-news', 'News Briefing', True),
            ('vis-calendar', 'p-calendar', 'Daily Schedule', True),
            ('vis-todo', 'p-todo', 'Todo List', True),
            ('vis-gmail', 'p-gmail', 'Gmail Inbox', True),
            ('vis-stock', 'p-stock', 'Ticker Monitor', True),
            ('vis-youtube', 'p-youtube', 'YouTube Music', True),
            ('vis-unit', 'p-unit', 'Unit Selection', True),
            ('vis-system', 'p-system', 'System Stats', True),
            ('vis-wallpaper', 'p-wallpaper', 'Wallpaper Control', True),
            ('vis-notion', 'p-notion', 'Notion Intelligence', True)
        ] %}
        
        {% for id, target, label, checked in panels %}
        <div class="menu-item">
            <label for="{{ id }}" data-i18n="panels.{{ target }}">{{ label }}</label>
            <label class="switch">
                <input type="checkbox" id="{{ id }}" {% if checked %}checked{% endif %} onchange="togglePanel('{{ target }}', this.checked)">
                <span class="slider"></span>
            </label>
        </div>
        {% endfor %}
        
        <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.1); margin: 20px 0;">
        
        <div class="sidebar-action-container">
            <button id="lock-toggle-btn" class="sidebar-btn" onclick="toggleWidgetLock()" data-i18n="sidebar.lock_widgets">
                LOCK WIDGETS
            </button>
            <button id="routine-manager-btn" class="sidebar-btn primary" onclick="openSchedulerManager()" data-i18n="sidebar.routine_manager">
                ðŸ•’ ROUTINE MANAGER
            </button>
            <button class="sidebar-btn accent" onclick="persistToServer().then(ok => ok && alert(_t('sidebar.sync_success')))" data-i18n="sidebar.save_settings">
                SAVE CLOUD SETTINGS
            </button>
            {% if is_sponsor() %}
            <a href="/studio" class="sidebar-btn studio" data-i18n="sidebar.studio">
                LIVE2D STUDIO
            </a>
            {% endif %}
            <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.1); margin: 5px 0;">
            <div style="display: flex; gap: 5px; margin-bottom: 10px;">
                <button onclick="I18nManager.setLanguage('ko')" class="sidebar-btn" style="padding: 5px; font-size: 0.7rem;">KOREAN</button>
                <button onclick="I18nManager.setLanguage('en')" class="sidebar-btn" style="padding: 5px; font-size: 0.7rem;">ENGLISH</button>
            </div>
            <a href="/logout" class="logout-btn" data-i18n="sidebar.logout" style="width: 100%; text-align: center;">SYSTEM LOGOUT</a>
        </div>
    </div>
</div>
