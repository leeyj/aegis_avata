# AEGIS Intelligence Dashboard - 기능 명세서 (Specification)

본 문서는 **AEGIS Intelligence Dashboard v4.8**에 현재 구현되어 실구동 중인 주요 기능들을 상세히 정의합니다.

---

## 1. 시스템 핵심 아키텍처 (Core Architecture)

### 1.1 지능형 비서 엔진
- **AI 통합**: Google Gemini 2.0 Flash 모델을 사용한 상황 인지형 브리핑 생성.
- **음성 합성(TTS)**: Edge-TTS를 활용한 자연스러운 다국어 음성 출력 및 실시간 오디오 캐싱.
- **반응형 아바타**: PixiJS 기반 Live2D 아바타 연동 및 데이터 연동형 리액션 시스템.

### 1.2 보안 및 설정 관리
- **인증 시스템**: 세션 기반의 로그인 보안 기능 제공.
- **환경 공유**: `secrets.json`, `settings.json` 등을 통한 민감 정보 분리 및 사용자 설정 영구 보존.

---

## 2. 주요 연동 위젯 (Integrated Widgets)

### 🌤️ 환경 정보 (Weather)
- **API**: OpenWeatherMap 실시간 데이터 연동.
- **기능**: 현재 기온, 습도, 풍속 및 날씨 상태 시각화. 날씨 상태에 따른 아바타 감정 표현 연동.

### 📈 금융/증권 (Finance & Stocks)
- **데이터 소스**: Yahoo Finance 실시간 시세 추적.
- **기능**: 주요 지수 및 개별 관심 종목 모니터링. ±3% 변동 시 아바타의 즉각적인 리액션(기쁨/놀람) 유도.

### 🗓️ 구글 인텔리전스 (Google Intelligence)
- **달력 및 할 일**: Google Calendar & Tasks API 연동을 통한 일정 브리핑.
- **지메일(Gmail)**: 미확인 중요 메일 감지 및 알림 기능.

### 📰 뉴스 티커 (News Ticker)
- **기능**: 슬라이딩 방식의 실시간 뉴스 헤드라인 노출 및 위젯 클릭 시 상세 뉴스 이동.

### 🎵 멀티미디어 (BGM Player)
- **YouTube Music**: 사용자의 플레이리스트 연동 및 백그라운드 재생 기능. 
- **애니메이션 연동**: 음악 리듬 및 TTS 출력에 동기화되는 아바타 립싱크 및 댄스 모드.

---

## 3. 라이브2D 별명 시스템 (Semantic Alias System)

### 3.1 기술적 특징
- **모델 중립성**: 각기 다른 파일명 규칙을 가진 Live2D 모델들을 `idle`, `joy`, `shock`, `sad` 등의 공통 키워드로 제어.
- **추론 엔진**: 파일명을 분석하여 자동으로 별명을 매핑하는 지능형 검증 도구 내장.

### 3.2 제어 방식
- **공통 리액션**: `reactions.json`에 정의된 별명 기반 액션이 로드된 모든 모델에서 동일하게 작동.

---

## 4. 라이브2D 스튜디오 (Live2D Studio) 💎

**Live2D Studio**는 개발자 및 숙련된 사용자가 새로운 캐릭터 모델을 AEGIS에 최적화하여 통합할 수 있도록 지원하는 전문 관리 도구입니다.

### 4.1 핵심 기능
- **실시간 모델 관리**: 로컬의 테스트 폴더(`test_models/`)에 위치한 모델을 실시간으로 로드하고 외형(줌, 위치)을 조정.
- **에일리어스 매니저(Alias Manager)**: 아바타의 복잡한 파일명(예: `motions/happy_01.motion3.json`)을 시스템 표준 키워드(`joy`, `shock` 등)로 시각적으로 매핑.
- **리액션 시뮬레이터(Simulator)**: `reactions.json`의 설정을 기반으로 주식 급등, 메일 수신 등의 이벤트를 가상으로 발생시켜 아바타의 반응을 즉각 검증.
- **원클릭 적용**: 최적화된 모델 설정과 매핑 정보를 실제 AEGIS 대시보드 운영 환경으로 즉시 배포.

### 4.2 주요 설정 및 파일 구조
- **에일리어스 파일 (`alias.json`)**: 모델 폴더 내에 생성되며, 시스템 표준 키워드와 실제 파일 경로 간의 매핑 정보를 저장합니다.
- **리액션 설정 (`config/reactions.json`)**: 이벤트 상황별 아바타의 행동(MOTION, EMOTION, TTS)을 정의합니다.
  - **이벤트-리액션 설정 예시**:
    ```json
    "gmail": {
      "new_mail": {
        "condition": "count > 0",
        "actions": [
          { "type": "MOTION", "alias": "shock" },
          { "type": "TTS", "template": "새로운 메일이 도착했습니다." }
        ]
      }
    }
    ```
- **환경 변수**: `routes/config.py`에서 지정된 `TEST_MODELS_DIR` 및 `MODELS_DIR` 경로를 통해 에셋을 관리합니다.

### 4.3 권한 정책 (Authorization) 🔒
- **스폰서 전용 (Sponsor Exclusive)**: 
  - **모델 적용(Apply)** 및 **에일리어스 저장(Save alias.json)** 기능은 AEGIS 후원자(Sponsor) 계정으로 인증된 사용자만 사용 가능합니다.
  - 일반 계정은 모델의 시각적 로드 및 시뮬레이션 버튼 동작 테스트까지만 허용됩니다.

---

## 5. 상태 저장 및 사용자 경험 (UX)

- **레이아웃 보존**: 위젯의 위치, 크기, 아바타의 오프셋 및 스튜디오에서의 뷰 설정 등이 영구적으로 유지됨.
- **디버그 모드**: API 할당량을 아끼기 위한 테스트 모드 및 가상 데이터 서비스 지원.

---
*최종 업데이트: 2026-02-26*
